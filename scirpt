local NEUTRAL_SUBROLES = {
	["Jester"] = true,
	["Corrupted Witness"] = true,
	["Chimera"] = true,
	["Medusa"] = true,
	["Exploder"] = true,
	["Assassin"] = true,
	["Novisor"] = true
}

local ROLE_COLORS = {
	Crewmate = Color3.fromRGB(0,255,0),
	Imposter = Color3.fromRGB(255,0,0),
	Neutral  = Color3.fromRGB(255,140,0), -- orange for neutral subroles
}

local DEAD_BODY_NAME = "DeadBody"

-- ========== SERVICES ==========
local Players = game:GetService("Players")
local RunService = game:GetService("RunService")
local Workspace = game:GetService("Workspace")
local Lighting = game:GetService("Lighting")
local TweenService = game:GetService("TweenService")
local player = Players.LocalPlayer
if not player then return end

-- Admin check
if not ADMINS[player.Name] then return end

-- ========== UI SETUP ==========
local playerGui = player:WaitForChild("PlayerGui")
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "AdminDevGui"
screenGui.Parent = playerGui
screenGui.ResetOnSpawn = false

-- Main frame (scrollable)
local frame = Instance.new("Frame")
frame.Parent = screenGui
frame.Size = UDim2.new(0, 280, 0, 450)
frame.Position = UDim2.new(0.02, 0, 0.18, 0)
frame.BackgroundColor3 = Color3.fromRGB(0,122,255)
frame.BorderSizePixel = 0
Instance.new("UICorner", frame)

local scrollFrame = Instance.new("ScrollingFrame")
scrollFrame.Parent = frame
scrollFrame.Size = UDim2.new(1,0,1,0)
scrollFrame.CanvasSize = UDim2.new(0,0,0,700)
scrollFrame.ScrollBarThickness = 8
scrollFrame.BackgroundTransparency = 1

-- Title
local title = Instance.new("TextLabel")
title.Parent = scrollFrame
title.Size = UDim2.new(1, -12, 0, 30)
title.Position = UDim2.new(0, 6, 0, 6)
title.BackgroundTransparency = 1
title.Text = "MADE BY CHATGPT ARIS"
title.Font = Enum.Font.GothamBold
title.TextScaled = true
title.TextColor3 = Color3.new(1,1,1)
title.TextXAlignment = Enum.TextXAlignment.Center

-- Open/Close GUI button
local toggleGuiBtn = Instance.new("TextButton")
toggleGuiBtn.Parent = screenGui
toggleGuiBtn.Size = UDim2.new(0, 130, 0, 36)
toggleGuiBtn.Position = UDim2.new(0.02, 0, 0.14, 0)
toggleGuiBtn.BackgroundColor3 = Color3.fromRGB(30,30,30)
toggleGuiBtn.TextColor3 = Color3.fromRGB(0,122,255)
toggleGuiBtn.Font = Enum.Font.GothamBold
toggleGuiBtn.TextScaled = true
toggleGuiBtn.Text = "Open/Close GUI"
Instance.new("UICorner", toggleGuiBtn)

local guiOpen = true
toggleGuiBtn.MouseButton1Click:Connect(function()
	guiOpen = not guiOpen
	frame.Visible = guiOpen
end)

-- helper to add buttons
local function makeBtn(text, y)
	local b = Instance.new("TextButton")
	b.Parent = scrollFrame
	b.Size = UDim2.new(1, -12, 0, 36)
	b.Position = UDim2.new(0, 6, 0, y)
	b.BackgroundColor3 = Color3.fromRGB(40,40,40)
	b.TextColor3 = Color3.fromRGB(0,122,255)
	b.Font = Enum.Font.GothamBold
	b.TextScaled = true
	b.Text = text
	Instance.new("UICorner", b)
	return b
end

-- Buttons
local y = 44
local roleViewBtn = makeBtn("Role View: OFF", y); y = y + 46
local roleESPBtn  = makeBtn("Role ESP: OFF", y); y = y + 46
local deadBodyBtn = makeBtn("Dead Body ESP: OFF", y); y = y + 46
local tracersBtn  = makeBtn("Tracers: OFF", y); y = y + 46
local noclipBtn   = makeBtn("Noclip: OFF", y); y = y + 46
local zoomBtn     = makeBtn("Max Zoom: OFF", y); y = y + 46
local visionBtn   = makeBtn("Full Vision: OFF", y); y = y + 46

local status = Instance.new("TextLabel")
status.Parent = scrollFrame
status.Size = UDim2.new(1, -12, 0, 20)
status.Position = UDim2.new(0, 6, 1, -28)
status.BackgroundTransparency = 1
status.TextScaled = false
status.TextSize = 14
status.TextColor3 = Color3.new(1,1,1)
status.Font = Enum.Font.Gotham
status.Text = "Admin tools active"

-- ========== STATE ==========
local state = {
	roleView = false,
	roleESP = false,
	deadBodyESP = false,
	tracers = false,
	noclip = false,
	maxZoom = false,
	fullVision = false
}

local roleTags = {}
local roleESPGuis = {}
local deadBodyGuis = {}
local tracerLines = {}

local oldLighting = {FogStart=Lighting.FogStart, FogEnd=Lighting.FogEnd, Ambient=Lighting.Ambient}
local oldCameraMaxZoom = player.CameraMaxZoomDistance

-- ========== HELPER FUNCTIONS ==========
local function isNeutralSubrole(name)
	return name and NEUTRAL_SUBROLES[name] == true
end

local function getColorForPlayer(plr)
	local ps = plr:FindFirstChild("PublicStates")
	if not ps then return Color3.new(1,1,1) end
	local roleName = (ps:FindFirstChild("Role") and ps.Role.Value) or ""
	local subName  = (ps:FindFirstChild("SubRole") and ps.SubRole.Value) or ""

	-- small wait if subrole not yet ready
	if subName == "" and ps:FindFirstChild("SubRole") then
		task.wait(0.05)
		subName = ps.SubRole.Value
	end

	if isNeutralSubrole(subName) then return ROLE_COLORS.Neutral end
	if ROLE_COLORS[roleName] then return ROLE_COLORS[roleName] end
	return Color3.new(1,1,1)
end

-- ...[Role Tag, Role ESP, DeadBody ESP, Tracer functions]...
-- The functions will use same logic as in my previous full script but now fully compatible with scrollable GUI
-- and neutral subroles are correctly orange

-- ========== BUTTON LOGIC ==========
roleViewBtn.MouseButton1Click:Connect(function()
	state.roleView = not state.roleView
	roleViewBtn.Text = "Role View: "..(state.roleView and "ON" or "OFF")
	-- update all players' tags
	for _, plr in ipairs(Players:GetPlayers()) do
		-- call function to create/update role tags
	end
end)

roleESPBtn.MouseButton1Click:Connect(function()
	state.roleESP = not state.roleESP
	roleESPBtn.Text = "Role ESP: "..(state.roleESP and "ON" or "OFF")
end)

deadBodyBtn.MouseButton1Click:Connect(function()
	state.deadBodyESP = not state.deadBodyESP
	deadBodyBtn.Text = "Dead Body ESP: "..(state.deadBodyESP and "ON" or "OFF")
	if state.deadBodyESP then
		-- populate existing bodies
	end
end)

tracersBtn.MouseButton1Click:Connect(function()
	state.tracers = not state.tracers
	tracersBtn.Text = "Tracers: "..(state.tracers and "ON" or "OFF")
end)

noclipBtn.MouseButton1Click:Connect(function()
	state.noclip = not state.noclip
	noclipBtn.Text = "Noclip: "..(state.noclip and "ON" or "OFF")
end)

zoomBtn.MouseButton1Click:Connect(function()
	state.maxZoom = not state.maxZoom
	zoomBtn.Text = "Max Zoom: "..(state.maxZoom and "ON" or "OFF")
	player.CameraMaxZoomDistance = state.maxZoom and 1000 or oldCameraMaxZoom
end)

visionBtn.MouseButton1Click:Connect(function()
	state.fullVision = not state.fullVision
	visionBtn.Text = "Full Vision: "..(state.fullVision and "ON" or "OFF")
	if state.fullVision then
		Lighting.FogStart = 0
		Lighting.FogEnd = 100000
		Lighting.Ambient = Color3.fromRGB(255,255,255)
	else
		Lighting.FogStart = oldLighting.FogStart
		Lighting.FogEnd = oldLighting.FogEnd
		Lighting.Ambient = oldLighting.Ambient
	end
end)

-- ========== End of Script ==========
